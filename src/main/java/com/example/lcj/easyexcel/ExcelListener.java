package com.example.lcj.easyexcel;

import java.io.FileWriter;
import java.io.IOException;
import java.util.*;

import org.apache.commons.lang3.StringUtils;

import com.alibaba.excel.context.AnalysisContext;
import com.alibaba.excel.event.AnalysisEventListener;
import com.alibaba.fastjson.JSON;
import com.beust.jcommander.internal.Lists;

public class ExcelListener extends AnalysisEventListener<Model> {

    private Set<String> logIds = new HashSet<String>();

    // 一行一行读取excel内容，把每行内容封装到User对象中
    // 从excel第二行还是读取(第一行是表头)
    @Override
    public void invoke(Model user, AnalysisContext context) {
        logIds.add(getLogId(user.getLogId()));
    }

    // 读取excel表头信息
    @Override
    public void invokeHeadMap(Map<Integer, String> headMap, AnalysisContext context) {
        System.out.println("表头：" + headMap);

    }

    // 读取完成后执行
    @Override
    public void doAfterAllAnalysed(AnalysisContext context) {
        Object json = JSON.toJSON(logIds);
        // 文件路径
        String filePath = "/Users/lichengjian/Downloads/output.txt";

        // 使用 FileWriter 写入文件
        try (FileWriter writer = new FileWriter(filePath)) {
            writer.write(json.toString());
            System.out.println("写入成功！");
        } catch (IOException e) {
            e.printStackTrace();
        }

    }


    public static String getLogId(String originalLogId) {
        if (StringUtils.isBlank(originalLogId)) {
            return null;
        }
        int index = StringUtils.indexOf(originalLogId, "_");

        return StringUtils.substring(originalLogId, index + 1);
    }

    public static void main(String[] args) {
        List<String> aa = Lists.newArrayList("wx4ez",
                "wx4er",
                "wx4en",
                "wx4g3",
                "wx4ep",
                "wx4g8",
                "wx4gc",
                "wx4fy",
                "wx4fc",
                "wx4ff",
                "wx4gd",
                "wx4eq",
                "wx4dw",
                "wx4g1",
                "wx4ex",
                "wx4ej",
                "wx4dz",
                "wx4ew",
                "wx4ey",
                "wx4g5",
                "wx4g6",
                "wx4g2",
                "wx4fb",
                "wx4dp",
                "wx4dy",
                "wx4g4",
                "wx4eh",
                "wx4sp",
                "wx4gj",
                "wx4e5",
                "wx4f8",
                "wx4g0",
                "wx4ev",
                "wx4dv",
                "wx4gh",
                "wx4dx",
                "wx4gn",
                "wx4f9",
                "wx4g9",
                "wx4d5",
                "wx4fz",
                "wx4dr",
                "wx4gp",
                "wx4sm",
                "wx4u0",
                "wx4em",
                "wx4uq",
                "wx4f6",
                "wx4f3",
                "wx4u1",
                "wx4sn",
                "wx4sj",
                "wx4du",
                "wx4gb",
                "wx4un",
                "wx4fk",
                "wx4eg",
                "wx4fg",
                "wx4dn",
                "wx4f4",
                "wx4fs",
                "wx4g7",
                "wx4et",
                "wx4f5",
                "wx4dq",
                "wx4e4",
                "wx4fu",
                "wx49g",
                "wx4u5",
                "wx4dh",
                "wx4f7",
                "wx4uw",
                "wx49y",
                "wx4sq",
                "wx4fv",
                "wx4ge",
                "wx4fe",
                "wx4sh",
                "wx4es",
                "wx4st",
                "wx4uh",
                "wx4d7",
                "wx4df",
                "wx4fh",
                "wx4f2",
                "wx4ek",
                "wx4d4",
                "wx4gk",
                "wx4gg",
                "wx4dk",
                "wx4um",
                "wx4fd",
                "wx4eu",
                "wx4e6",
                "wx499",
                "wx4e1",
                "wx4gu",
                "wx4dt",
                "wx4dg",
                "wx4sw",
                "wx43z",
                "wx54b",
                "wx4s5",
                "wx4gs",
                "wx4fm",
                "wx4up",
                "wx550",
                "wx4ef",
                "wx4gw",
                "wx4f1",
                "wx4u8",
                "wx4gv",
                "wx4d6",
                "wx4de",
                "wx4u4",
                "wx4gf",
                "wx49f",
                "wx4sk",
                "wx4ds",
                "wx4cb",
                "wx4u6",
                "wx4gr",
                "wx4f0",
                "wx4gq",
                "wx4s4",
                "wx4s6",
                "wx49c",
                "wx49b",
                "wx4u3",
                "wx49z",
                "wx49w",
                "wx4uj",
                "wx4ft",
                "wx4gy",
                "wx4u2",
                "wx4fw",
                "wx5h0",
                "wx4se",
                "wx49x",
                "wx4uk",
                "wx4ur",
                "wx4ss",
                "wx4cz",
                "wx4cc",
                "wx4fx",
                "wx5h8",
                "wx4e3",
                "wx4d3",
                "wx4fr",
                "wx4dc",
                "wx4sx",
                "wx4d1",
                "wx4gt",
                "wx4fn",
                "wx4e7",
                "wx548",
                "wx4s9",
                "wx4fq",
                "wx4ud",
                "wx4s1",
                "wx49d",
                "wx49u",
                "wx5h2",
                "wx4sr",
                "wx4u7",
                "wx4s7",
                "wx4gx",
                "wx49t",
                "wx4fj",
                "wx4db",
                "wx4dd",
                "wx4gm",
                "wx552",
                "wx4cf",
                "wx4ut",
                "wx4us",
                "wx4cg",
                "wx4sd");

        List<String> bb = Lists.newArrayList(
                "wx4g3527",
                "wx4g2526",
                "wx4ep520",
                "wx4dz499",
                "wx4g8486",
                "wx4eq441",
                "wx4ez419",
                "wx4fc419",
                "wx4en388",
                "wx4ff384",
                "wx4g4358",
                "wx4fb353",
                "wx4ex324",
                "wx4g0317",
                "wx4er296",
                "wx4g5295",
                "wx4ew284",
                "wx4g1282",
                "wx4gd281",
                "wx4gc272",
                "wx4dy271",
                "wx4ey270",
                "wx4g6257",
                "wx4dw231",
                "wx4gb219",
                "wx4gj214",
                "wx4sp205",
                "wx4eh180",
                "wx4sn180",
                "wx4f9177",
                "wx4dv172",
                "wx4f8172",
                "wx4fy170",
                "wx4ej170",
                "wx4ev169",
                "wx4g9164",
                "wx4fg160",
                "wx4d5158",
                "wx4gn155",
                "wx4un147",
                "wx4u1138",
                "wx4g7136",
                "wx4u0135",
                "wx4dx134",
                "wx4e5130",
                "wx4fz126",
                "wx4f6126",
                "wx4uq125",
                "wx4dp119",
                "wx4f3113",
                "wx4gp113",
                "wx4sm105",
                "wx5k2103",
                "wx4fk97",
                "wx4gh94",
                "wx4sv92",
                "wx5jd92",
                "wx4fv89",
                "wx4sj85",
                "wx4dh84",
                "wx4du79",
                "wx4et79",
                "wx4fe78",
                "wx4f477",
                "wx4fh77",
                "wx4f576",
                "wx4st72",
                "wx49g68",
                "wx4dq66",
                "wx4dn66",
                "wx4sq64",
                "wx4e463",
                "wx4em63",
                "wx4gk63",
                "wx4dr61",
                "wx4up60",
                "wx4fu60",
                "wx4dg59",
                "wx4fd59",
                "wx4su58",
                "wx4gg57",
                "wx4uw57",
                "wx4ge57",
                "wx5je56",
                "wx4gu52",
                "wx4cb51",
                "wx4ek48",
                "wx4d448",
                "wx4df48",
                "wx54b45",
                "wx4dt45",
                "wx4u444",
                "wx4e644",
                "wx4f243",
                "wx4vq41",
                "wx49c40",
                "wx4gv39",
                "wx4qp37",
                "wx4gw36",
                "wx4d735",
                "wx4vw33",
                "wx4f733",
                "wx4es33",
                "wx4um32",
                "wx4f132",
                "wx4eg32",
                "wx4u530",
                "wx4eu30",
                "wx4sk29",
                "wx4s428",
                "wx4sw27",
                "wx4ss26",
                "wx4fs26",
                "wx49y25",
                "wx4vm24",
                "wx4ur23",
                "wx49z23",
                "wx5jg22",
                "wx4f022",
                "wx4ef22",
                "wx4u322",
                "wx4gy21",
                "wx4u220",
                "wx4dk20",
                "wx55019",
                "wx4ds19",
                "wx4e119",
                "wx4qn18",
                "wx4uy18",
                "wx4gf17",
                "wx4us17",
                "wx4fm16",
                "wx49f16",
                "wx4u616",
                "wx4sh15",
                "wx5k315",
                "wx5jf14",
                "wx4gq14",
                "wx4uj14",
                "wx48y14",
                "wx4vj13",
                "wx49u13",
                "wx4s513",
                "wx4sy12",
                "wx55y12",
                "wx4d612",
                "wx4ct12",
                "wx4cc12",
                "wx5h012",
                "wx49911",
                "wx4sx11",
                "wx4fr10",
                "wx4e310",
                "wx4ft10",
                "wx5jt10",
                "wx4de10",
                "wx5h610",
                "wx4sf9",
                "wx4ub9",
                "wx4vf9",
                "wx5439",
                "wx4fw9",
                "wx4dd9",
                "wx4c99",
                "wx4929",
                "wx4s69",
                "wx5k99",
                "wx5k89",
                "wx4ug9",
                "wx4cf9",
                "wx4e99",
                "wx4vz8",
                "wx46n8",
                "wx4fx8",
                "wx4uh8",
                "wx4fn8",
                "wx5h48",
                "wx5k67",
                "wx4uz7",
                "wx4mx7",
                "wx51c7",
                "wx4gs7",
                "wx4uk7",
                "wx5hw7",
                "wx5hc7",
                "wx4s97",
                "wx43y7",
                "wx49n7",
                "wx4vr7",
                "wx4s77",
                "wx5487",
                "wx49x7",
                "wx4u77",
                "wx5497",
                "wx4cw7",
                "wx4vk7",
                "wx43z6",
                "wx4vn6",
                "wx4uv6",
                "wx54k6",
                "wx49w6",
                "wx4fj6",
                "wx4dc6",
                "wx4vx6",
                "wx4c76",
                "wx4ut6",
                "wx4sr6",
                "wx4ud6",
                "wx4gr6",
                "wx4d16",
                "wx4c46",
                "wx5426",
                "wx4se6",
                "wx4sd6",
                "wx4u86",
                "wx54c6",
                "wx4vh5",
                "wx4we5",
                "wx5j85",
                "wx4bc5",
                "wx5j25",
                "wx5n65",
                "wx41w5",
                "wx5jv5",
                "wx5n45",
                "wx4c24",
                "wx5h84",
                "wx5j14",
                "wx4ce4",
                "wx43k4",
                "wx5ks4",
                "wx5454",
                "wx4gx4",
                "wx4db4",
                "wx4cz4",
                "wx4vs4",
                "wx4mt4",
                "wx4ux4",
                "wx4s34",
                "wx51f4",
                "wx4sg4",
                "wx4v84",
                "wx5hx4",
                "wx4e73",
                "wx43h3",
                "wx5jc3",
                "wx5hd3",
                "wx5j93",
                "wx5443",
                "wx5kt3",
                "wx54f3",
                "wx4353",
                "wx5413",
                "wx55b3",
                "wx4vp3",
                "wx5p03",
                "wx43x3",
                "wx42f3",
                "wx5q93",
                "wx5rh3",
                "wx55f3",
                "wx4d23",
                "wx4gt3",
                "wx4t52",
                "wx4902",
                "wx5hf2",
                "wx4cq2",
                "wx4mw2",
                "wx5k02",
                "wx5ns2",
                "wx55v2",
                "wx4e22",
                "wx43p2",
                "wx49d2",
                "wx4w02",
                "wx4fq2",
                "wx43w2",
                "wx49k2",
                "wx4ue2",
                "wx43q2",
                "wx4tj2",
                "wx4qh2",
                "wx5402",
                "wx5j62",
                "wx4fp2",
                "wx4th2",
                "wx4ee2",
                "wx4w22",
                "wx5hb2",
                "wx5462",
                "wx4w32",
                "wx5qc2",
                "wx4gm2",
                "wx5ny2",
                "wx5k42",
                "wx4cx2",
                "wx4uu2",
                "wx5jj2",
                "wx5h72",
                "wx5hj2",
                "wx49b2",
                "wx5hn2",
                "wx5hq1",
                "wx5hg1",
                "wx4671",
                "wx4qk1",
                "wx4c81",
                "wx4931",
                "wx5m91",
                "wx5531",
                "wx4cu1",
                "wx49t1",
                "wx4q71",
                "wx4wf1",
                "wx5kd1",
                "wx43t1",
                "wx4vt1",
                "wx4zw1",
                "wx5j41",
                "wx48z1",
                "wx5h21",
                "wx4vy1",
                "wx4tm1",
                "wx5581",
                "wx46f1",
                "wx5k11",
                "wx5ke1",
                "wx5hm1",
                "wx5521",
                "wx4qr1",
                "wx5nn1",
                "wx4y91",
                "wx5h51",
                "wx4cm1",
                "wx4cy1",
                "wx4gz1",
                "wx4721",
                "wx5511",
                "wx4c01",
                "wx55g1",
                "wx4941",
                "wx4c11",
                "wx46z1",
                "wx5hr1",
                "wx5nv1",
                "wx5131",
                "wx4v41",
                "wx4w91",
                "wx51d1",
                "wx5h11",
                "wx49r1");

        for (String geo : aa) {
            Optional<String> first = bb.stream().filter(b -> b.contains(geo)).findFirst();
            if (first.isPresent()) {
                System.out.println(geo + " " + StringUtils.substring(first.get(), 5));
            } else {
                System.out.println(geo + " " + 0);
            }
        }
    }
}
